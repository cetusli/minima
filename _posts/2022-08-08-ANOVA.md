---
layout: post
title: "Analysis of Variance"
author: Cetus Li
date: 2022-08-08
---
#### **方差分析（Analysis of Variance，ANOVA）**
方差分析是一种通过分析方差来检验两个或多个均值之间差异的统计学方法。前面提到多个均值之间的差异比较可以用 Tukey HSD Test。
他们的特点：
- Tukey HSD Test 采用两两比较，计算量大但是结果具体。
- ANOVA 比较笼统，它假设所有均值都相等，零假设： $\mu_{1}$ = $\mu_{2}$ = ... = $\mu_{k}$ 被拒绝只能说明至少有一个均值不等于剩下的其中至少一个均值。这种非特异性零假设有时称为综合零假设（the omnibus null hypothesis）。
- 有些复杂的分析无法使用 Tukey HSD Test ，但可以使用 ANOVA。
- ANOVA 是目前最常用的比较均值方法。

#### **方差分析设计（Analysis of Variance Designs，ANOVA Designs）**
- 方差分析设计中的 Factors and Levels：Factor 就是独立自变量，Level 是自变量取值个数。
- 一个 Factor 的方差分析叫做 a one-way ANOVA，n 个 Factor 的方差分析叫做 a n-way ANOVA。
- Factor 根据每个 Level 是否对应同一个实验对象可以分为对象内因子（within-subjects factor）和对象间因子（between-subjects factor）。
- 因子设计（factorial design）举例：Gender (2) x Age (3)，括号里的数字是 Factor 的 Level。
- 复杂因子设计：Factor 数量大于等于 2，同时含有对象间因子和对象内因子。

#### **对象间单因子方差分析（Between-Subjects One-Factor ANOVA）**
条件假设：
1. 总体具有方差齐性， $\sigma ^{2}$ 。
2. 总体是正态分布。
3. 每个观测值都是独立的（因为是对象间设计）。
- Factor(k)：单因子 Factor 有 k 个 level。
- 方差分析的零假设 $H_{0}$ 为： $\mu_{1}$ = $\mu_{2}$ = ... = $\mu_{k}$ 。
- 从不同角度对总体方差 $\sigma^{2}$ 做两次估计，分别是 MSE 和 MSB。在零假设成立的情况下，MSE=MSB= $\sigma^{2}$ 。
- 不管各水平均值是否相等，MSE 都是对总体方差的估计，而 MSB 只在各水平均值相等时才是对总体方差的估计，若不等则 MSB 变大，均值之间差异越大，MSB 越大。
- 对 F=MSB/MSE 做 F 分布检验，若 p 达到显著性水平则拒绝零假设，并得出结论：至少有一个均值不等于剩下的其中至少一个均值。
- MSE 由各水平的方差计算而来，不需要假设方差齐性。MSE=( $S_{1}$ + $S_{2}$ +...+ $S_{k}$ )/k。
- MSB 由各水平的均值计算而来，需要假设方差齐性。MSB=n $S_{M}^{2}$ 。（因为抽样均值方差 $\sigma_{M}^{2}= \frac{\sigma^{2}}{n}$ ）
- n 是各水平的观测数，这里假设各水平观测数相同，总观测数 N=nk 。
- $S_{M}^{2} = \frac{(M_{1}- M_{M})^2+ (M_{2}- M_{M})^2 +...+ (M_{k}- M_{M})^2}{k-1}$ ， $M_{M}=\frac{M_{1}+M_{2}+...+M_{k}}{k}$ 。


