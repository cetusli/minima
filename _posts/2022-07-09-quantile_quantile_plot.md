---
layout: post
title: "Quantile-Quantile Plots"
author: Cetus Li
date: 2022-07-09
---

#### *Q-Q 图（Quantile-Quantile Plots）*
q-q 图是使用分位数来验证数据是否服从某种分布的高级图形。q-q 图测试样本是否来自指定分布，横坐标为指定分布的理论值，纵坐标为样本值，如果点不接近直线，则有证据表明样本不是来自指定分布。q-q 图的难点在于理解指定分布理论分位数的计算，但是不理解也没关系，常见分布的理论分位数计算在程序里是现成的。

#### 探索数据分布
对于一个测量了 1000 个记录的指标，先把这 1000 个数按序排列，用直方图初步观察数据分布。
因为直方图涉及分箱（binning）,分箱大小对图形形状影响较大，而且不存在所谓最佳分箱大小。所以需要结合 q-q 图探索指标的真实分布。
在初步观察数据分布后，对分布进行假设，针对每一种假设分布进行 q-q 图验证。一般在样本量适中和较大的情况下，理论分布与实际分布的分位数的相关性大于 95% 时，可以认定假设分布即为真实分布。

#### 均匀数据的 Q-Q 图
样本数据量为 n ，把数据从小到大排列，都除以 `全距+1` ，就把数据标准化到 0-1 内，得到 $0 < u_{(1)} < u_{(2)} < ... < u_{(n)} < 1$ 的样本数据。均匀分布 Q-Q 图由 n 个有序的数据对组成，横坐标是理论数据（0-1 的每一个 n 分位数），纵坐标是样本数据。

$$ (\frac{i-0.5}{n} ,u_{(i)} ) , i\in (1,2,...,n) $$

#### 正态分布的 Q-Q 图
样本数据量为 n ，把数据从小到大排列，假设样本数据是正态分布，全部减去均值后除以标准差，得到处于标准正态分布中的样本数据 $-\infty < z_{(1)} < z_{(2)} < ... < z_{(n)} < +\infty$ 。正态分布 Q-Q 图的横坐标是标准正态分布累计概率(0-1)的 n 分位数所对应的 z 值。

z 的累计概率函数是 F(z) = q 的话，也就是变量小于等于 z 值的概率为 q。因为 $q = \frac{i-0.5 }{n}  , i\in (1,2,...,n)$ ，所以

$$ z = F^{-1}( \frac{i-0.5 }{n})  , i\in (1,2,...,n) $$

正态分布 Q-Q 图由 n 个有序的数据对组成。

$$ (F^{-1}( \frac{i-0.5 }{n}),z_{(i)})  , i\in (1,2,...,n) $$

#### *等高线图（Contour plots）*
等高线图在二维上展示三维数据。

#### *3D绘图(3D plots)*
3D绘图也算是在二维上展示三维数据。
3D绘图的一个著名应用是检测伪随机数生成器中的非随机性。
